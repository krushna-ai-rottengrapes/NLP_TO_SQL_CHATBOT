table_name,description
"AdminAccounts","PURPOSE: Stores administrative and staff user accounts who manage the tour system. These accounts create and manage locations (pins), tour packages, and road trips. COLUMNS: id (serial PK - unique identifier), email (text - admin email address), phoneNo (text - contact phone number), password (text - hashed password for authentication), username (text - display name), gender (text - gender information), createdAt (timestamptz DEFAULT now() - account creation timestamp), role (text - user role like admin/staff/manager), resetPasswordToken (text - token for password reset functionality), resetPasswordExpires (timestamptz - expiration time for reset token). FOREIGN KEY REFERENCES: None (this is a parent table). REFERENCED BY: Location.userId (FK with ON DELETE SET NULL - locations created by this admin), TourPackage.userId (FK with ON DELETE SET NULL - tour packages created by this admin), RoadTrip.userId (FK with ON DELETE CASCADE - road trips created by this admin). INDEXES: admin_name_idx on username for faster lookups. BUSINESS LOGIC: When an admin account is deleted, their locations and tour packages remain but userId is set to NULL (orphaned records), while their road trips are completely deleted. No unique constraint on email - consider adding for data integrity. RELATIONSHIPS: One admin can create many Locations (1:N), many TourPackages (1:N), and many RoadTrips (1:N)."
"Categories","PURPOSE: Master lookup table for categorizing different types of locations/places in the system (e.g., Hotels, Restaurants, Main Attractions, Activities, Markets, Famous Photo Points, etc.). Each location must belong to exactly one category. COLUMNS: id (serial PK - unique category identifier), name (text NOT NULL UNIQUE - category name like 'Hotels', 'Main Attraction', 'Places to Eat'), svg (text - SVG icon data for category display), btnIcon (text - button icon reference), position (integer - display order/sorting position), createdAt (timestamptz DEFAULT now() - when category was created). FOREIGN KEY REFERENCES: None (this is a parent/lookup table). REFERENCED BY: Location.categoryId (FK with ON DELETE CASCADE - all locations in this category). BUSINESS LOGIC: Categories are foundational data - deleting a category will cascade delete ALL locations in that category, so use with extreme caution. Category names must be unique. Used for filtering and organizing pins on maps and in the UI. RELATIONSHIPS: One category can have many Locations (1:N)."
"Location","PURPOSE: Core table representing physical places/points of interest (PINS) registered in the tour management system. These are the fundamental building blocks - hotels, attractions, restaurants, activities, etc. that are used throughout the system in reels, road trips, and tour packages. COLUMNS: id (serial PK), placeName (text NOT NULL - name of the place), location (geometry(point, SRID 4326) NOT NULL - PostGIS point with lat/long coordinates), locationType (text NOT NULL - type descriptor), travelPath (geometry(linestring, SRID 4326) - optional path/route geometry), rating (integer DEFAULT 0 - rating 0-5 with CHECK constraint), categoryId (integer NOT NULL - FK to Categories), bestTimeToVisit (text - recommended visiting period), link (text - external URL/reference), country (text - country name), state (text - state/province), city (text - city name), cta (boolean DEFAULT false - call-to-action flag), status (enum 'status' DEFAULT 'pending' - approval status: approved/pending/rejected/expired), shopHyperLink (text - shopping/booking link), activityType (text - specific activity classification), userId (integer - FK to AdminAccounts who created this pin), createdAt (timestamptz DEFAULT now()), user (json - denormalized user data for performance). FOREIGN KEY REFERENCES: categoryId -> Categories.id (ON DELETE CASCADE - must belong to valid category), userId -> AdminAccounts.id (ON DELETE SET NULL - creator reference). REFERENCED BY: Reels.locationId (ON DELETE SET NULL), RoadTrip.sourceId and destinationId (ON DELETE CASCADE), roadTripSubways.subwayPointId (ON DELETE CASCADE), Iternary.sourceId and destinationId (ON DELETE CASCADE), IternarySubPoints.locationId (ON DELETE CASCADE), IternaryRoute.sourceId and destinationId (ON DELETE CASCADE). INDEXES: name_idx on placeName for text search, spatial indexes on geometry columns for geographic queries. BUSINESS LOGIC: Locations are heavily referenced - deleting a location cascades to road trips and itineraries but only nullifies reel references. Status workflow: pending -> approved/rejected. Requires PostGIS extension for spatial operations. RELATIONSHIPS: Belongs to one Category (N:1), created by one AdminAccount (N:1), can have many Reels (1:N), used as source/destination in many RoadTrips (1:N each), used as stops in many roadTripSubways (1:N), used in many Iternary legs (1:N)."
"Reels","PURPOSE: Stores social media content (Instagram reels, YouTube videos, Twitter/X posts) associated with locations. These are short-form video/media references that showcase places, used for marketing and user engagement. Each reel is tagged with content type flags and can have call-to-action buttons. COLUMNS: id (serial PK), platform (text NOT NULL - CHECK constraint: 'instagram', 'youtube', or 'twitter'), link (text NOT NULL - URL to the media with CHECK for https?:// format), placeName (text NOT NULL - name of featured place), locationId (integer - optional FK to Location), travelReview (boolean - content type flag), destinationGuide (boolean - content type flag), placeToEat (boolean - content type flag), mainAttraction (boolean - content type flag), language (text - content language), month (text - relevant month/season), status (enum 'status' DEFAULT 'pending' - approval workflow), createdAt (timestamptz DEFAULT now()), expireDate (date DEFAULT '3099-12-31' - when content should expire/be hidden), addCTA (boolean DEFAULT false - whether to show call-to-action), CTAName (text - CTA button text, column name has space: 'CTA Button name'), CTAURL (text - CTA button URL, column name has space: 'CTA Button link'), tourPackageId (text - reference to associated tour package), user (json - denormalized user data), type (text - additional type classification). FOREIGN KEY REFERENCES: locationId -> Location.id (ON DELETE SET NULL - optional location association). REFERENCED BY: None (leaf table). BUSINESS LOGIC: Reels can exist without a location (locationId nullable) for general content. Multiple boolean flags allow one reel to be tagged with multiple content types. Platform evolved from instagram/youtube/tiktok to instagram/youtube/twitter. Status workflow for content moderation. Expiration date allows automatic hiding of outdated content. WARNING: Column names 'CTA Button name' and 'CTA Button link' contain spaces which can cause ORM issues. RELATIONSHIPS: Optionally belongs to one Location (N:1)."
"RoadTrip","PURPOSE: Represents curated road trip routes between two locations (source and destination). Road trips are journey offerings that connect pins and can include multiple intermediate stops (subways) and detailed route geometry. Created and managed by admin accounts. COLUMNS: id (serial PK), sourceId (integer NOT NULL - FK to starting Location), destinationId (integer NOT NULL - FK to ending Location), sourceLocation (geometry(point, SRID 4326) - denormalized source coordinates for performance), destinationLocation (geometry(point, SRID 4326) - denormalized destination coordinates), status (enum 'status' - approval status: approved/pending/rejected/expired), userId (integer - FK to AdminAccounts creator), createdAt (timestamptz DEFAULT now()). FOREIGN KEY REFERENCES: sourceId -> Location.id (ON DELETE CASCADE - must have valid source), destinationId -> Location.id (ON DELETE CASCADE - must have valid destination), userId -> AdminAccounts.id (ON DELETE CASCADE - creator). REFERENCED BY: roadTripSubways.roadTripId (ON DELETE CASCADE - intermediate stops), roadTripRoutes.roadTripId (ON DELETE CASCADE - route geometries). BUSINESS LOGIC: Deleting either source or destination location will cascade delete the entire road trip and all its subways and routes. Deleting the creator admin also deletes the road trip. Geometry columns are denormalized from Location references for query performance. A road trip can have multiple route variations (stored in roadTripRoutes) and multiple intermediate stops (in roadTripSubways). RELATIONSHIPS: Has one source Location (N:1), one destination Location (N:1), created by one AdminAccount (N:1), has many roadTripSubways stops (1:N), has many roadTripRoutes (1:N)."
"roadTripSubways","PURPOSE: Junction/join table that stores intermediate stop points (waypoints) for a road trip. Allows a road trip to have multiple ordered stops between source and destination. The 'subway' terminology refers to sub-way-points or intermediate waypoints along the journey. COLUMNS: id (serial PK), roadTripId (integer NOT NULL - FK to parent RoadTrip), subwayPointId (integer NOT NULL - FK to Location that is the stop), position (integer NOT NULL - ordering of stops, lower numbers come first), location (geometry(point, SRID 4326) - denormalized coordinates for performance). FOREIGN KEY REFERENCES: roadTripId -> RoadTrip.id (ON DELETE CASCADE - belongs to road trip), subwayPointId -> Location.id (ON DELETE CASCADE - references a location pin). REFERENCED BY: None (leaf table). BUSINESS LOGIC: Deleting a road trip cascades to delete all its subway stops. Deleting a location that is used as a subway point also deletes that stop entry. Position field enables ordered stops (e.g., Stop 1, Stop 2, Stop 3). Multiple road trips can reference the same location as a stop. Geometry is denormalized from Location for performance. Consider adding composite index on (roadTripId, position) for efficient ordered retrieval. RELATIONSHIPS: Belongs to one RoadTrip (N:1), references one Location as the stop point (N:1)."
"roadTripRoutes","PURPOSE: Stores detailed route geometry and metadata for road trips. A single road trip can have multiple route records (e.g., different route options, scenic route vs fastest route). Route data is stored as JSON containing coordinates, distances, durations, and other routing information. COLUMNS: id (serial PK), roadTripId (integer NOT NULL - FK to parent RoadTrip), route (json - route geometry and metadata as JSON object, consider JSONB for better querying). FOREIGN KEY REFERENCES: roadTripId -> RoadTrip.id (ON DELETE CASCADE - belongs to road trip). REFERENCED BY: None (leaf table). BUSINESS LOGIC: Deleting a road trip cascades to delete all its route records. JSON structure typically contains polyline coordinates, distance, duration, waypoints, and other routing metadata from mapping APIs. Multiple routes per road trip allow offering alternative paths. Consider migrating to JSONB type and adding GIN indexes if you need to query inside the JSON structure. RELATIONSHIPS: Belongs to one RoadTrip (N:1)."
"TourPackage","PURPOSE: Represents complete tour products/offerings - multi-day curated travel packages with itineraries. These are the main sellable products in the system, containing multiple days of planned activities and routes. Each package has a theme, duration, and is associated with a geographic location. COLUMNS: id (serial PK), name (text NOT NULL - package name/title), location (geometry(point, SRID 4326) NOT NULL - main location/center point of tour), theme (text NOT NULL - tour theme like 'Adventure', 'Cultural', 'Beach Holiday'), link (text - external booking/info link), country (text), state (text), city (text), cta (boolean - call-to-action flag), language (text - tour language), days (integer - number of days), nights (integer - number of nights), status (enum 'status' - approval status: approved/pending/rejected/expired), shopHyperLink (text - shopping/booking URL), userId (integer - FK to AdminAccounts creator), createdAt (timestamptz DEFAULT now()). FOREIGN KEY REFERENCES: userId -> AdminAccounts.id (ON DELETE SET NULL - creator reference). REFERENCED BY: Iternary.tourPackageId (ON DELETE CASCADE - daily itinerary legs). BUSINESS LOGIC: Tour packages are composed of multiple Iternary records (one per day or per leg). Deleting a tour package cascades to delete all its itinerary legs, sub-points, and routes. If creator admin is deleted, package remains but userId becomes NULL. Location is stored as geometry point (consider if this should be FK to Location table instead for consistency). Status workflow for approval process. Days/nights define package duration. RELATIONSHIPS: Created by one AdminAccount (N:1), has many Iternary legs (1:N)."
"Iternary","PURPOSE: Represents individual legs/segments within a tour package's itinerary. Each record is typically one day or one journey segment of the tour, connecting a source location to a destination location with transport and timing details. Multiple iternary records compose a complete tour package. NOTE: Table name is misspelled (should be 'Itinerary'). COLUMNS: id (serial PK), tourPackageId (integer - FK to parent TourPackage), sourceId (integer - FK to starting Location for this leg), destinationId (integer - FK to ending Location for this leg), day (integer - which day of the tour this leg occurs), color (text - UI color coding for map display), transportMedium (text - mode of transport: car, bus, train, flight, etc.), timeFrame (text - time duration or schedule for this leg). FOREIGN KEY REFERENCES: tourPackageId -> TourPackage.id (ON DELETE CASCADE - belongs to tour package), sourceId -> Location.id (ON DELETE CASCADE - starting point), destinationId -> Location.id (ON DELETE CASCADE - ending point). REFERENCED BY: IternarySubPoints.iternaryId (ON DELETE CASCADE - intermediate stops), IternaryRoute.iternaryId (ON DELETE CASCADE - route geometry). BUSINESS LOGIC: Each leg connects two locations and can have multiple sub-points (stops along the way) and route geometries. Deleting the parent tour package cascades to delete all legs. Deleting a location used as source/destination also deletes affected legs. Day field allows ordering of legs in sequence. Color helps visualize different legs on maps. RELATIONSHIPS: Belongs to one TourPackage (N:1), has one source Location (N:1), one destination Location (N:1), has many IternarySubPoints (1:N), has many IternaryRoute records (1:N)."
"IternarySubPoints","PURPOSE: Stores ordered intermediate stop points within a single itinerary leg. Similar to roadTripSubways but for tour package itineraries. Allows an itinerary leg to have multiple waypoints between its source and destination. COLUMNS: id (serial PK), iternaryId (integer - FK to parent Iternary leg), locationId (integer - FK to Location that is the stop), position (integer - ordering of stops within the leg, lower numbers first), color (text - UI color coding for map display). FOREIGN KEY REFERENCES: iternaryId -> Iternary.id (ON DELETE CASCADE - belongs to itinerary leg), locationId -> Location.id (ON DELETE CASCADE - references a location pin). REFERENCED BY: None (leaf table). BUSINESS LOGIC: Deleting an itinerary leg cascades to delete all its sub-points. Deleting a location used as a sub-point also deletes that stop entry. Position field enables ordered stops within a leg. Color allows visual differentiation on maps. Consider adding composite index on (iternaryId, position) for efficient ordered retrieval. RELATIONSHIPS: Belongs to one Iternary leg (N:1), references one Location as the stop point (N:1)."
"IternaryRoute","PURPOSE: Stores detailed route geometry and metadata for individual itinerary legs. Each itinerary leg can have multiple route records (e.g., different route options). Route data stored as JSON containing coordinates, distances, and routing information. COLUMNS: id (serial PK), iternaryId (integer - FK to parent Iternary leg), route (json - route geometry and metadata, consider JSONB for querying), color (text - UI color coding for map display), sourceId (integer - FK to starting Location, redundant with Iternary.sourceId), destinationId (integer - FK to ending Location, redundant with Iternary.destinationId). FOREIGN KEY REFERENCES: iternaryId -> Iternary.id (ON DELETE CASCADE - belongs to itinerary leg), sourceId -> Location.id (ON DELETE CASCADE - starting point), destinationId -> Location.id (ON DELETE CASCADE - ending point). REFERENCED BY: None (leaf table). BUSINESS LOGIC: Deleting an itinerary leg cascades to delete all its routes. JSON structure contains polyline coordinates, distance, duration, and routing metadata. sourceId and destinationId are somewhat redundant with parent Iternary but may be used for direct queries. Consider JSONB type and GIN indexes for JSON querying. RELATIONSHIPS: Belongs to one Iternary leg (N:1), references source Location (N:1), references destination Location (N:1)."
"posts","PURPOSE: Demo/example table for testing purposes. Not part of the core tour management system. Represents sample blog posts or content items linked to users. COLUMNS: id (serial PK), content (text - post content), user_id (integer - FK to users table). FOREIGN KEY REFERENCES: user_id -> users.id. REFERENCED BY: None. BUSINESS LOGIC: This appears to be sample/scaffolding code for testing Drizzle ORM relationships. Should be removed in production or repurposed if needed for actual blog/content functionality. RELATIONSHIPS: Belongs to one user (N:1)."
"users","PURPOSE: Demo/example table for testing purposes. Not part of the core tour management system. Minimal user table for testing relationships. COLUMNS: id (serial PK), name (text - user name). FOREIGN KEY REFERENCES: None. REFERENCED BY: posts.user_id. BUSINESS LOGIC: This is sample/scaffolding code for testing Drizzle ORM. Should be removed in production. The actual user management is handled by AdminAccounts table. RELATIONSHIPS: Has many posts (1:N)."
